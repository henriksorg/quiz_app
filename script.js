let questionsHTML = [
  {
    "question": "Who invented HTML?",
    "answer_0": "Robbie Williams",
    "answer_1": "Lady Gaga",
    "answer_2": "Tim Berners-Lee",
    "answer_3": "Justin Biber",
    "right_answer": 2,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Who is making the Web standards?",
    "answer_0": "The World Wide Web Consortium ",
    "answer_1": "Microsoft",
    "answer_2": "Mozilla",
    "answer_3": "Google",
    "right_answer": 0,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Choose the correct HTML element for the largest heading:",
    "answer_0": "\< h1 \>",
    "answer_1": "\< h6 \>",
    "answer_2": "\< heading \>",
    "answer_3": "\< head \>",
    "right_answer": 0,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "What is the correct HTML element for inserting a line break?",
    "answer_0": "\< lb \>",
    "answer_1": "\< break \>",
    "answer_2": "\< br \>",
    "answer_3": "\< b \>",
    "right_answer": 2,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Choose the correct HTML element to define important text",
    "answer_0": "\< important \>",
    "answer_1": "\< b \>",
    "answer_2": "\< i \>",
    "answer_3": "\< strong \>",
    "right_answer": 3,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Which of these elements are all <table> elements?",
    "answer_0": "\< table \>\< head \>\< tfoot \>",
    "answer_1": "\< table \>\< tr \>\< td \>  ",
    "answer_2": "\< table \>\< tr \>\< tt \>",
    "answer_3": "\< thead \>\< body \>\< tr \>",
    "right_answer": 1,
    "answered": false,
    "selected_answer": ""
  },
]


let questionsNBA = [
  {
    "question": "Which NBA Player has won the most championships?",
    "answer_0": "Bill Russel",
    "answer_1": "Lebron James",
    "answer_2": "Michael Jordan",
    "answer_3": "Kobe Bryant",
    "right_answer": 0,
    "answered": false,
    "selected_answer": ""
  }, {
    "question": "Who was the number 1 pick in the 2018 NBA draft?",
    "answer_0": "Trae Young",
    "answer_1": "Deandre Ayton",
    "answer_2": "Luka Doncic",
    "answer_3": "Triple J",
    "right_answer": 1,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "How long is the NBA shotclock?",
    "answer_0": "22 seconds",
    "answer_1": "23 seconds",
    "answer_2": "24 seconds",
    "answer_3": "25 seconds",
    "right_answer": 2,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Which NBA MVP did Kobe Bryant Play wiith in his first 3 championship years?",
    "answer_0": "Lebron James",
    "answer_1": "Shaquille O Neil",
    "answer_2": "Kobe Bryant Sr.",
    "answer_3": "Stephen Curry",
    "right_answer": 1,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Stephen Curry, Kevin Durant, Draymond Green and ... were the 4 all stars of the Warriors in the 2017-2018 season",
    "answer_0": "Klay Thompson",
    "answer_1": "Josh Okogie",
    "answer_2": "Andre Iguedala",
    "answer_3": "Kevon Looney",
    "right_answer": 0,
    "answered": false,
    "selected_answer": ""
  },
]


let questionsGermany = [
  {
    "question": "What is the capital city of Germany",
    "answer_0": "Berlin",
    "answer_1": "Hamburg",
    "answer_2": "Stuttgart",
    "answer_3": "Munich",
    "right_answer": 3,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "What is Saarland?",
    "answer_0": "a national park",
    "answer_1": "an amusement park",
    "answer_2": "a federal state",
    "answer_3": "a location from a fairytale",
    "right_answer": 2,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Where can you find the ‘Englischer Garten’?",
    "answer_0": "Munich",
    "answer_1": "Bremen",
    "answer_2": "Leipzig",
    "answer_3": "Dresden",
    "right_answer": 0,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Which of the following is Germany’s highest mountain peak?",
    "answer_0": "Brocken",
    "answer_1": "Zugspitze",
    "answer_2": "Feldberg",
    "answer_3": "Nebelhorn",
    "right_answer": 1,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "In Germany, the word ‘Gymnasium’ usually refers to…",
    "answer_0": "sporting arena",
    "answer_1": "fitness studio",
    "answer_2": "military training facility",
    "answer_3": "school",
    "right_answer": 3,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "In which state will you find the Black Forest?",
    "answer_0": "Bavaria",
    "answer_1": "Mecklenburg-Vorpommern",
    "answer_2": "Thuringia",
    "answer_3": "Baden-Württemberg",
    "right_answer": 3,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "What daily German television program is preceded by the sound of a gong?",
    "answer_0": "Die Sendung mit der Maus",
    "answer_1": "Tatort",
    "answer_2": "Tagesschau",
    "answer_3": "Lindenstrasse",
    "right_answer": 2,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Where in Germany are you most likely to hear the greeting: Moin!",
    "answer_0": "Frankfurt",
    "answer_1": "Leipzig",
    "answer_2": "Hamburg",
    "answer_3": "Ulm",
    "right_answer": 3,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "How many years did it take to complete the Cathedral of Cologne? ",
    "answer_0": "12",
    "answer_1": "150",
    "answer_2": "632",
    "answer_3": "1004",
    "right_answer": 2,
    "answered": false,
    "selected_answer": ""
  },
]


let questionsElectronics = [
  {
    "question": "Electronics is the science and technology concerned with regulating flow of:",
    "answer_0": "Heat",
    "answer_1": "Water",
    "answer_2": "Electricity",
    "answer_3": "Power",
    "right_answer": 2,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Which of the following is not a physical component of an electronic circuit?",
    "answer_0": "Capacitor",
    "answer_1": "Inductor",
    "answer_2": "Diode",
    "answer_3": "Temperature",
    "right_answer": 3,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "Current is measured in:",
    "answer_0": "Ohms",
    "answer_1": "Amperes",
    "answer_2": "Voltage",
    "answer_3": "Watts",
    "right_answer": 1,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "If you have three 1.5V batteries connected in parallel, what would be total voltage be? ",
    "answer_0": "3.4 V",
    "answer_1": "1.5 V",
    "answer_2": "4.5 V",
    "answer_3": "3 V",
    "right_answer": 1,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "An AA battery holder with 6 cells provides how many total volts?",
    "answer_0": "1.5V",
    "answer_1": "9V",
    "answer_2": "6V",
    "answer_3": "3V",
    "right_answer": 0,
    "answered": false,
    "selected_answer": ""
  },
  {
    "question": "What is the correct formula for Ohm's law?",
    "answer_0": "P = U * I",
    "answer_1": "R = U * I",
    "answer_2": "I = U * R",
    "answer_3": "R = U / I",
    "right_answer": 3,
    "answered": false,
    "selected_answer": ""
  }
]


let currentQuestion = 0;
let rightAnswers = 0;
let questions = questionsElectronics;
let answeredQuestions = 0;
let currentQuiz = '';
let nextQuiz = '';
let startPage = true;

let AUDIO_SUCCESS = new Audio('audio/right.wav');
AUDIO_SUCCESS.volume = 0.5;
let AUDIO_FAIL = new Audio('audio/wrong.wav');
AUDIO_FAIL.volume = 0.5;



function init() {
  renderStartPage();
}


function disableLinksAtStartPage(){
  document.getElementById('nav-link-bar').style = 'pointer-events: none';
}


function enableLinksAtOtherPage(){
  document.getElementById('nav-link-bar').style = 'pointer-events: unset';
}


function renderStartPage() {
  body = document.getElementById('card-body');
  body.innerHTML = renderStartPageTemplate();
  disableLinksAtStartPage();
}


function renderStartPageTemplate() {
  return /*html*/`
  <h2>Welcome to QuizzIt</h2>
  <h3>Which Quiz do you want to Play?</h3>
  <button onclick="renderWelcomePage('HTML')" class="btn btn-outline-danger mt-4 w-50">HTML-Quiz</button>
  <button id="NBA" onclick="renderWelcomePage('NBA')" class="btn btn-outline-primary mt-4 w-50">NBA-Quiz</button>
  <button id="Germany" onclick="renderWelcomePage('Germany')" class="btn btn-outline-warning mt-4 w-50">Germany-Quiz</button>
  <button id="Electronics" onclick="renderWelcomePage('Electronics')" class="btn btn-outline-secondary mt-4 w-50">Electronics-Quiz</button>
  `
}


function renderWelcomePage(quizName) {
  currentQuiz = quizName;
  body = document.getElementById('card-body');
  body.innerHTML = renderWelcomePageTemplate();
  chooseQuiz();
  highlightSection();
  enableLinksAtOtherPage();
}


function renderWelcomePageTemplate() {
  return /*html*/`
    <div class="headlines-home-page">
    <h3> <span>Welcome to</span> <span>The Awesome ${currentQuiz} Quiz</span></h3>
    <h4>Ready for the challenge?</h4>
  </div>
  <div class="w-100 d-flex justify-content-end my-5">
    <button class="btn btn-primary font-size-20 d-flex align-items-center start-button" onclick="renderQuestionsPage()">
      Start now <i class="arrow-css turn-right mt-1 ms-2 me-1"></i>
    </button>
  </div>
  `
}

function chooseQuiz() {
  if (currentQuiz === 'HTML') {
    questions = questionsHTML;
  } else if (currentQuiz === 'NBA') {
    questions = questionsNBA;
  } else if (currentQuiz === 'Germany') {
    questions = questionsGermany;
  } else if (currentQuiz === 'Electronics') {
    questions = questionsElectronics;
  }
}


function highlightSection() {
  document.getElementById(currentQuiz).classList.add('highlight');
}


function renderQuestionsPage() {
  body = document.getElementById('card-body');
  body.innerHTML = renderQuestionsPageTemplate();
  showQuestion();
}


function renderQuestionsPageTemplate() {
  return /*html*/`
    <span class="card-text" id="quiz-question">Question</span>
      <div class="card quiz-answer-card mt-1 d-flex flex-row align-items-center border-white" id="answer0" onclick="answer(0)">
        <div class="answer-letter">A</div>
        <div class="card-body" id="insert-answer0">
          Answer
        </div>
      </div>
      <div class="card quiz-answer-card mt-1 d-flex flex-row align-items-center border-white" id="answer1" onclick="answer(1)">
        <div class="answer-letter">B</div>
        <div class="card-body" id="insert-answer1">
          Answer
        </div>
      </div>
      <div class="card quiz-answer-card mt-1 d-flex flex-row align-items-center border-white" id="answer2" onclick="answer(2)">
        <div class="answer-letter">C</div>
        <div class="card-body" id="insert-answer2">
          Answer
        </div>
      </div>
      <div class="card quiz-answer-card mt-1 d-flex flex-row align-items-center border-white" id="answer3" onclick="answer(3)">
        <div class="answer-letter">D</div>
        <div class="card-body" id="insert-answer3">
          Answer
        </div>
      </div>
      <button onclick="changeQuestion(-1)" class="arrow arrow-left cursor-not-allowed" id="button-arrow-left" disabled><img src="img/icon-links.png" alt="zurück" ></button>
      <button onclick="changeQuestion(1)" class="arrow arrow-right cursor-not-allowed" id="button-arrow-right" disabled><img src="img/icon-rechts.png" alt="weiter"></button>
      `
}


function defineQuestion() {
  let question = questions[currentQuestion];
  removeResult();
  showQuestion();
  if (question["answered"] == true) {
    blockAnswers();
    enableNextQuestion();
  } else {
    allowAnswers();
    disableNextQuestion();
  }
  showSolution();
  enablePreviousQuestion();
}


function showQuestion() {
  let question = questions[currentQuestion];
  document.getElementById('quiz-question').innerHTML = question["question"];
  for (let i = 0; i <= 3; i++) {
    document.getElementById("insert-answer" + i).innerHTML = question["answer_" + i];
  }
}


function answer(selection) {
  let question = questions[currentQuestion];
  answeredQuestions++;
  saveAnswer(question, selection);
  showSolution();
  countRightAnswers(question, selection);
  enableNextQuestion();
  blockAnswers();
  progressBar();
}


function progressBar() {
  let percentage = Math.round(answeredQuestions / questions.length * 100);
  document.getElementById('progress-bar').style.width = `${percentage}%`;
}


function countRightAnswers(question, selection) {
  if (question["right_answer"] == selection) {
    rightAnswers++;
  }
}


function showSolution() {
  let question = questions[currentQuestion];
  let selctedAnswer = question["selected_answer"];
  let rightAnswer = 'answer' + question["right_answer"];
  if (question["answered"] == true && selctedAnswer == rightAnswer) {
    document.getElementById(question["selected_answer"]).classList.add('backgrd_gr');
    AUDIO_SUCCESS.play();
  } else if (question["answered"] == true && selctedAnswer != rightAnswer) {
    document.getElementById(question["selected_answer"]).classList.add('backgrd_red');
    AUDIO_FAIL.play();
  }
}


function blockAnswers() {
  for (let i = 0; i <= 3; i++) {
    document.getElementById('answer' + i).classList.add('pointer-events-none');
  }
}


function allowAnswers() {
  for (let i = 0; i <= 3; i++) {
    document.getElementById('answer' + i).classList.remove('pointer-events-none');
  }
}


function saveAnswer(question, selection) {
  question["answered"] = true;
  question["selected_answer"] = "answer" + selection;
}


function enableNextQuestion() {
  let question = questions[currentQuestion];
  if (question["answered"]) {
    document.getElementById('button-arrow-right').disabled = false;
    document.getElementById('button-arrow-right').classList.remove('cursor-not-allowed');
  }
}


function disableNextQuestion() {
  document.getElementById('button-arrow-right').disabled = true;
  document.getElementById('button-arrow-right').classList.add('cursor-not-allowed')
}


function changeQuestion(operator) {
  currentQuestion += (operator);
  if (currentQuestion < 0) {
    currentQuestion = 0;
  } else if (currentQuestion >= questions.length) {
    renderResult();
  } else {
    defineQuestion();
  }
}


function enablePreviousQuestion() {
  if (currentQuestion == 0) {
    document.getElementById('button-arrow-left').disabled = true;
    document.getElementById('button-arrow-left').classList.add('cursor-not-allowed')
  } else if (currentQuestion > 0) {
    document.getElementById('button-arrow-left').disabled = false;
    document.getElementById('button-arrow-left').classList.remove('cursor-not-allowed')
  }
}


function removeResult() {
  for (let i = 0; i <= 3; i++) {
    document.getElementById('answer' + i).classList.remove('backgrd_gr');
    document.getElementById('answer' + i).classList.remove('backgrd_red');
  }
}


function whichAnswerSelcted() {
  let question = questions[currentQuestion];
  let selctedAnswer = question["selected_answer"];
  let rightAnswer = 'answer' + question["right_answer"];
  if (question["answered"] == true && selctedAnswer == rightAnswer) {
    document.getElementById(question["selected_answer"]).classList.add('backgrd_gr')
  } else if (question["answered"] == true && selctedAnswer != rightAnswer) {
    document.getElementById(question["selected_answer"]).classList.add('backgrd_red');
  }
}


function renderResult() {
  let body = document.getElementById('card-body')
  body.innerHTML = renderResultTemplate()
}


function renderResultTemplate() {
  return /*html*/`
    <div class="result-headline">
      <img src="/img/brain_result.png" alt="brain">
      <h2><span>QUIZ COMPLETE!!</span></h2>
    </div>
    <div class="end-result"><span class="your-score">Your Score</span><span class="right-answers">${rightAnswers}/${questions.length}</span></div>
    <div class="d-flex flex-column w-100 align-items-center">
      <button class="btn btn-primary w-25 btn-resp">SHARE</button>
      <button class="btn btn-outline-primary mt-1 w-25 btn-resp" onclick="replayQuiz()">REPLAY</button>
    </div>
    <div class="trophy-container"><img src="img/tropy.png" alt="Trophy"></div>
  `
}


function replayQuiz() {
  resetAllValues();
  renderStartPage();
}


function resetAllValues() {
  currentQuestion = 0;
  rightAnswers = 0;
  answeredQuestions = 0;
  document.getElementById('progress-bar').style.width = '0';
  document.getElementById(currentQuiz).classList.remove('highlight');
  for (i = 0; i < questions.length; i++) {
    let question = questions[i];
    question["answered"] = false;
    question["selected_answer"] = "";
  }
}


function changeToOtherQuizAlert(quizName) {
  nextQuiz = quizName;
  openAlert();
}


function changeToOtherQuiz(decision) {
  if (decision == true) {
    quizname = nextQuiz;
    closeAlert(); 
    resetAllValues();
    renderWelcomePage(quizname);
  } else {
    closeAlert();
  }
}


function openAlert(){
  document.getElementById('alert-bg').classList.remove('d-none');
  document.getElementById('alert').classList.remove('d-none');
}


function closeAlert(){
  document.getElementById('alert-bg').classList.add('d-none');
  document.getElementById('alert').classList.add('d-none');
}